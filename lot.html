<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blockchain Fair Lottery</title>
    <link rel="stylesheet" href="stylescss">
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        body {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    text-align: center;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.wallet-info {
    margin-bottom: 20px;
}

.tabs {
    display: flex;
    justify-content: space-around;
    margin-bottom: 20px;
}

.tab-button {
    padding: 10px 20px;
    cursor: pointer;
    border: none;
    background: #007bff;
    color: white;
    border-radius: 5px;
}

.lottery-panel {
    display: none;
}

.lottery-panel.active {
    display: block;
}

button {
    margin: 10px;
    padding: 10px 15px;
    background: #28a745;
    color: white;
    border-radius: 5px;
    cursor: pointer;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
}

.modal-content {
    background: white;
    padding: 20px;
    margin: 15% auto;
    width: 50%;
    text-align: center;
    border-radius: 5px;
}

.close {
    float: right;
    cursor: pointer;
}
    </style>
</head>
<body>
    <div class="container">
        <h1>Blockchain Fair Lottery</h1>

        <!-- Wallet Info -->
        <div class="wallet-info">
            <button id="connectWalletBtn" onclick="connectWallet()">üîó Connect Wallet</button>
            <button id="disconnectWalletBtn" onclick="disconnectWallet()" style="display:none;">‚ùå Disconnect</button>
            <p>Wallet: <span id="walletAddress">Not connected</span></p>
            <p>Saldo USDT: <span id="usdtBalance">-</span> USDT</p>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('daily')">Lotre Harian</button>
            <button class="tab-button" onclick="switchTab('weekly')">Lotre Mingguan</button>
            <button class="tab-button" onclick="switchTab('monthly')">Lotre Bulanan</button>
        </div>

        <!-- Lottery Panels -->
        <div id="daily" class="lottery-panel active">
            <h2>Lotre Harian</h2>
            <p>Harga Tiket: 1.5 USDT</p>
            <p>Tiket Dibeli: <span id="dailyTickets">-</span></p>
            <p>Countdown: <span id="dailyCountdown">--:--:--</span></p>
            <button onclick="openBuyModal('daily', 1.5)">Beli Tiket</button>
        </div>

        <div id="weekly" class="lottery-panel">
            <h2>Lotre Mingguan</h2>
            <p>Harga Tiket: 5 USDT</p>
            <p>Tiket Dibeli: <span id="weeklyTickets">-</span></p>
            <p>Countdown: <span id="weeklyCountdown">--:--:--</span></p>
            <button onclick="openBuyModal('weekly', 5)">Beli Tiket</button>
        </div>

        <div id="monthly" class="lottery-panel">
            <h2>Lotre Bulanan</h2>
            <p>Harga Tiket: 10 USDT</p>
            <p>Tiket Dibeli: <span id="monthlyTickets">-</span></p>
            <p>Countdown: <span id="monthlyCountdown">--:--:--</span></p>
            <button onclick="openBuyModal('monthly', 10)">Beli Tiket</button>
        </div>

        <!-- Mini Explorer -->
        <div class="mini-explorer">
            <h2>Riwayat Pembelian Tiket</h2>
            <ul id="purchaseHistory">
                <li>Belum ada transaksi</li>
            </ul>
        </div>

        <!-- Status Pemenang -->
        <div class="winner-status">
            <h2>Hasil Undian</h2>
            <p>Juara 1: <span id="winner1">-</span> (50%)</p>
            <p>Juara 2: <span id="winner2">-</span> (20%)</p>
            <p>Juara 3: <span id="winner3">-</span> (10%)</p>
            <p>Pemenang Lain: <span id="winnerOthers">-</span></p>
        </div>
    </div>

    <!-- Modal Pembelian Tiket -->
    <div id="buyModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBuyModal()">&times;</span>
            <h2>Beli Tiket</h2>
            <p>Jenis Lotre: <span id="lotteryType"></span></p>
            <label>Jumlah Tiket:</label>
            <input type="number" id="ticketAmount" min="1" max="100" value="1" oninput="updateTotal()">
            <p>Total Harga: <span id="totalPrice">0</span> USDT</p>
            <button onclick="buyTicket()">Beli</button>
        </div>
    </div>

    <script src="scriptjs"></script>

    <script>
        let web3;
let account;

// Fungsi Connect Wallet
async function connectWallet() {
    if (window.ethereum) {
        web3 = new Web3(window.ethereum);
        await window.ethereum.request({ method: "eth_requestAccounts" });
        const accounts = await web3.eth.getAccounts();
        account = accounts[0];
        document.getElementById("walletAddress").innerText = account;
        document.getElementById("connectWalletBtn").style.display = "none";
        document.getElementById("disconnectWalletBtn").style.display = "block";

        updateBalance();
    } else {
        alert("MetaMask tidak ditemukan. Harap install.");
    }
}

// Fungsi Disconnect Wallet
function disconnectWallet() {
    account = null;
    document.getElementById("walletAddress").innerText = "Not connected";
    document.getElementById("connectWalletBtn").style.display = "block";
    document.getElementById("disconnectWalletBtn").style.display = "none";
    document.getElementById("usdtBalance").innerText = "-";
}

// Fungsi Update Saldo
async function updateBalance() {
    // Simulasi saldo
    let fakeBalance = Math.floor(Math.random() * 1000);
    document.getElementById("usdtBalance").innerText = fakeBalance;
}

// Fungsi Countdown
function startCountdown() {
    function updateCountdown(elementId, duration) {
        let targetTime = Date.now() + duration;
        let interval = setInterval(() => {
            let now = Date.now();
            let remaining = Math.max(0, targetTime - now);
            let hours = Math.floor(remaining / 3600000);
            let minutes = Math.floor((remaining % 3600000) / 60000);
            let seconds = Math.floor((remaining % 60000) / 1000);
            document.getElementById(elementId).innerText = `${hours}:${minutes}:${seconds}`;
            if (remaining <= 0) clearInterval(interval);
        }, 1000);
    }
    updateCountdown("dailyCountdown", 86400000);
    updateCountdown("weeklyCountdown", 604800000);
    updateCountdown("monthlyCountdown", 2592000000);
}

// Fungsi Membeli Tiket
async function buyTicket() {
    let amount = document.getElementById("ticketAmount").value;
    let lotteryType = document.getElementById("lotteryType").innerText;

    alert(`Membeli ${amount} tiket untuk ${lotteryType}...`);
    document.getElementById("purchaseHistory").innerHTML += `<li>${account} beli ${amount} tiket di ${lotteryType}</li>`;
    
    closeBuyModal();
}

window.onload = function() {
    connectWallet();
    startCountdown();
};
    </script>
</body>
</html>
